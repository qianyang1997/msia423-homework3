# Classifying Clouds
Follow instructions below to run the modeling pipeline for the cloud dataset from UCI.
#### Preliminary Step: Set configurations in config/config.yaml
Set hyperparameters for the random forest classifier, html source to download raw data, etc. Currently there are 'output_paths' specified for each feature generation step; if output paths are specified, then the dataframe generated by each function in the feature generation step will be saved locally.
## Option to run commands with Makefile
### Step 1: Build the image
```
make image
```
### Step 2: Acquire the raw data
Download the raw cloud data from https://archive.ics.uci.edu/ml/machine-learning-databases/undocumented/taylor/cloud.data. The url link should be placed in the 'save_data' section of the yaml file.
```shell script
make acquire
```
### Step 3: Execute pipeline
Execute the following commands in sequence:
```shell script
make read # Reorganize raw data into csv format #
make featurize # Make the features #
make train # Fit a random forest model with custom hyperparameters #
make evaluate # Evaluate the model on the test set #
```
Alternative, execute Step 2 and Step 3 in a bundle with the following command:
```shell script
make all
```
### Optional step: Run tests
Run unit tests on feature generation functions with the following command:
```shell script
make tests
```
### Rerun pipeline
After executing unit tests, you can rerun the pipeline and conduct unit tests again. To do so, you need to clean up the "data" folder with the following command:
```shell script
make clean
```
If this step is not executed, some `make all` commands will not be able to run.

## Option to run commands with bash script

### Step 1: Build the image
```shell script
docker build -f Dockerfile_bash -t cloud .
```
### Step 2: Execute the pipeline from start to finish
```shell script
docker run --mount type=bind,source="$(pwd)/data",target=/app/data/ cloud run-pipeline.sh
```
### Run tests
```shell script
docker run --mount type=bind,source="$(pwd)/data",target=/app/data/ --entrypoint "pytest" cloud tests
```